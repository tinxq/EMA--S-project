<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Emo-Tion for English</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f8f0ff;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 800px;
        margin: 20px auto;
        background: #fff;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    h1 {
        color: #d63384;
    }
    .question {
        margin: 15px 0;
        font-weight: bold;
        color: #333;
    }
    .options {
        margin-bottom: 20px;
    }
    .options label {
        display: block;
        margin: 5px 0;
        padding: 10px;
        background: #e0f0ff;
        border-radius: 10px;
        cursor: pointer;
        transition: 0.3s;
    }
    .options label:hover {
        background: #cfe2ff;
    }
    button {
        background: #d63384;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 10px;
        font-size: 16px;
        cursor: pointer;
        margin: 10px;
    }
    button:hover {
        background: #a61e5c;
    }
    .hidden {
        display: none;
    }
    .message {
        font-size: 18px;
        margin: 20px 0;
        padding: 15px;
        border-radius: 10px;
    }
    .success {
        background: #d1e7dd;
        color: #0f5132;
    }
    .fail {
        background: #f8d7da;
        color: #842029;
    }
</style>
</head>
<body>

<div class="container">
    <h1>اختبار تحديد المستوى - Emo-Tion</h1>

    <div id="studentInfo">
        <label>ادخل اسمك:</label>
        <input type="text" id="studentName" placeholder="اسم الطالب">
        <button onclick="startTest()">ابدأ الاختبار</button>
    </div>

    <div id="quiz" class="hidden">
        <div id="questions"></div>
        <button onclick="checkAnswers()">تأكيد الإجابات</button>
        <button id="nextBtn" class="hidden" onclick="nextLevel()">المستوى التالي</button>
        <div id="message" class="message hidden"></div>
    </div>
</div>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
<script>
  // 🔹 بيانات مشروعك من Firebase Console
  const firebaseConfig = {
    apiKey: "YOUR_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "1234567890",
    appId: "APP_ID"
  };

  // Initialize Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

<script>
const levels = ["Pre0", "Pre1", "A1", "A2", "B1", "B2"];
let currentLevel = 0;
let studentName = "";

// 🔹 أسئلتك
const questions = {
    "Pre0": [
        { q: "What is the color of the sky?", options: ["Blue", "Green", "Red"], answer: "Blue" },
        { q: "What is 2 + 2?", options: ["3", "4", "5"], answer: "4" },
        { q: "Which is an animal?", options: ["Car", "Dog", "Chair"], answer: "Dog" },
        { q: "Which is a fruit?", options: ["Apple", "Table", "Book"], answer: "Apple" },
        { q: "What do you drink?", options: ["Water", "Shoe", "Pen"], answer: "Water" }
    ],
    "Pre1": [
        { q: "What is opposite of hot?", options: ["Cold", "Warm", "Heat"], answer: "Cold" },
        { q: "Which one is a verb?", options: ["Run", "Chair", "Book"], answer: "Run" },
        { q: "What is 5 - 2?", options: ["2", "3", "4"], answer: "3" },
        { q: "Which one is a day of the week?", options: ["January", "Monday", "Year"], answer: "Monday" },
        { q: "Which is a color?", options: ["Dog", "Red", "Car"], answer: "Red" }
    ],
    "A1": [
        { q: "She ____ to school every day.", options: ["go", "goes", "going"], answer: "goes" },
        { q: "I ____ a book now.", options: ["read", "am reading", "reads"], answer: "am reading" },
        { q: "We ____ football yesterday.", options: ["play", "played", "playing"], answer: "played" },
        { q: "They ____ to London next week.", options: ["travel", "travels", "traveling"], answer: "travel" },
        { q: "He ____ breakfast at 7 am.", options: ["have", "has", "having"], answer: "has" }
    ],
    "A2": [
        { q: "If it ____ tomorrow, we will stay home.", options: ["rain", "rains", "raining"], answer: "rains" },
        { q: "I have ____ friends in my class.", options: ["much", "many", "a"], answer: "many" },
        { q: "She has lived here ____ 2010.", options: ["for", "since", "from"], answer: "since" },
        { q: "I ____ to Paris last year.", options: ["go", "went", "gone"], answer: "went" },
        { q: "This is the ____ book I have ever read.", options: ["more interesting", "most interesting", "interesting"], answer: "most interesting" }
    ],
    "B1": [
        { q: "I wish I ____ taller.", options: ["am", "were", "was"], answer: "were" },
        { q: "She said she ____ help me.", options: ["will", "would", "can"], answer: "would" },
        { q: "The book ____ by my teacher.", options: ["was given", "is gave", "gave"], answer: "was given" },
        { q: "He has been working here ____ 5 years.", options: ["since", "for", "from"], answer: "for" },
        { q: "It’s the first time I ____ sushi.", options: ["eat", "ate", "have eaten"], answer: "have eaten" }
    ],
    "B2": [
        { q: "Had I known, I ____ earlier.", options: ["will leave", "would have left", "left"], answer: "would have left" },
        { q: "Not only ____ late, but also forgot his homework.", options: ["he arrived", "did he arrive", "arrived he"], answer: "did he arrive" },
        { q: "If I ____ you, I would study harder.", options: ["was", "were", "am"], answer: "were" },
        { q: "The man, ____ car was stolen, is my uncle.", options: ["who", "whose", "which"], answer: "whose" },
        { q: "No sooner ____ the bell rang than the students left.", options: ["had", "has", "have"], answer: "had" }
    ]
};

function startTest() {
    studentName = document.getElementById("studentName").value;
    if (!studentName) {
        alert("⚠️ من فضلك ادخل اسمك");
        return;
    }
    document.getElementById("studentInfo").classList.add("hidden");
    document.getElementById("quiz").classList.remove("hidden");
    loadQuestions();
}

function loadQuestions() {
    const qDiv = document.getElementById("questions");
    qDiv.innerHTML = `<h2>المستوى: ${levels[currentLevel]}</h2>`;
    questions[levels[currentLevel]].forEach((item, index) => {
        qDiv.innerHTML += `
            <div class="question">${item.q}</div>
            <div class="options">
                ${item.options.map(opt => `
                    <label><input type="radio" name="q${index}" value="${opt}"> ${opt}</label>
                `).join("")}
            </div>
        `;
    });
}

function checkAnswers() {
    let correct = 0;
    questions[levels[currentLevel]].forEach((item, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        if (selected && selected.value === item.answer) correct++;
    });

    const messageDiv = document.getElementById("message");
    messageDiv.classList.remove("hidden");

    if (correct >= 4) {
        messageDiv.textContent = `✅ اجتزت المستوى ${levels[currentLevel]}`;
        messageDiv.className = "message success";
        saveResult(studentName, levels[currentLevel], "Passed");
        document.getElementById("nextBtn").classList.remove("hidden");
    } else {
        messageDiv.textContent = `❌ مستواك هو: ${levels[currentLevel]}`;
        messageDiv.className = "message fail";
        saveResult(studentName, levels[currentLevel], "Failed");
        document.getElementById("nextBtn").classList.add("hidden");
    }
}

function nextLevel() {
    currentLevel++;
    if (currentLevel < levels.length) {
        document.getElementById("message").classList.add("hidden");
        document.getElementById("nextBtn").classList.add("hidden");
        loadQuestions();
    } else {
        document.getElementById("questions").innerHTML = "<h2>🎉 انتهى الاختبار! شكرا لمشاركتك</h2>";
        document.getElementById("nextBtn").classList.add("hidden");
    }
}

// 🔹 حفظ النتائج في Firebase
function saveResult(name, level, status) {
    db.collection("results").add({
        student: name,
        level: level,
        status: status,
        date: new Date()
    }).then(() => {
        console.log("✅ Result saved!");
    }).catch((error) => {
        console.error("❌ Error saving result: ", error);
    });
}
</script>

</body>
</html>
